(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{BFx0:function(t,a,e){"use strict";e.r(a);var o=e("ta7f"),i=e("gR0X");function s(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,o)}return e}function r(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var c=new i.h,n=new i.e,l=new i.w,u=new i.v,m={data:function(){return{form:{id:null,descricao:"",parceiro_id:"",qtde_futuras:12,periodicidade:"MENSAL",classificacao:"",plano_conta_id:"",centro_custo_id:"",ativo:!1,parceiro:null,plano_conta:null,centro_custo:null,vencimento_inicial:null,valor_inicial:0},acao:"Desativar",sucessoAtivar:null,erroAtivar:null,sucesso:null,erros:null,errosTitulo:"",timer:null,centros_custo:[],parceiros:[],planos_contas:[],periodicidades:["SEMANAL,MENSAL,BIMESTRAL,TRIMESTRAL,SEMESTRAL,ANUAL"],classificacoes:["ADMINISTRATIVA","OPERACIONAL","COMISSAO","OUTROS","PESSOAL"],inteiro:{decimal:",",thousands:".",prefix:"",suffix:"",precision:0,masked:!1}}},validations:function(){var t=this;return{form:{descricao:{required:o.required,maxLength:Object(o.maxLength)(200)},parceiro_id:{required:o.required},qtde_futuras:{required:o.required,minValue:Object(o.minValue)(1),maxValue:Object(o.maxValue)(60)},periodicidade:{required:o.required},classificacao:{required:o.required},plano_conta_id:{required:o.required},centro_custo_id:{required:o.required},vencimento_inicial:{required:Object(o.requiredIf)((function(){return!t.form.id}))},valor_inicial:{required:Object(o.requiredIf)((function(){return!t.form.id})),minValue:Object(o.minValue)(.01)}}}},mounted:function(){this.$route.params.id&&this.buscarObjeto(this.$route.params.id),this.buscarCentroCusto()},methods:{submit:function(){var t=this;if(this.$v.form.$touch(),this.erros=null,this.sucesso=null,this.errosTitulo="",this.$v.form.$invalid)return this.errosTitulo="Preencha o formulário corretamente, alguns campos estão com erros!",this.erros=this.$v.form,!1;var a=function(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?s(Object(e),!0).forEach((function(a){r(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):s(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}({},this.form);delete a.ativo,delete a.parceiro,delete a.plano_conta,delete a.centro_custo;(a.id?c.atualizar(a):c.criar(a)).then((function(a){var e=!t.form.id;if(t.sucesso="Registro salvo com sucesso!",e){t.form.id=a.data.id;var o=String(t.$route.path).lastIndexOf("/"),i=String(t.$route.path).slice(0,o);i+="/"+t.form.id,t.$router.push(i),t.buscarObjeto(t.form.id)}})).catch((function(a){return t.erros=a}))},buscarObjeto:function(t){var a=this;c.buscar(t).then((function(t){a.form=t.data,a.form.valor_inicial=Number(a.form.valor_inicial)})).catch((function(t){return a.erros=t}))},buscarParceiroDebounce:function(t,a){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.buscarParceiro(t,a)}),800)},buscarParceiro:function(t,a){var e=this,o={texto:t,per_page:40};u.listar(o).then((function(t){return e.parceiros=t.data.data}))},selecionouClassificacaoConta:function(){var t=this;this.form.plano_conta_id="",this.form.plano_conta=null,setTimeout((function(){t.buscarContaDespesa()}),50)},buscarContaDespesaDebounce:function(t,a){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.buscarContaDespesa(t,a)}),800)},buscarContaDespesa:function(t,a){var e=this;if(this.form.classificacao){var o={tipo:this.form.classificacao,texto:t,per_page:40};l.listar(o).then((function(t){return e.planos_contas=t.data.data.map((function(t){return t.nome=t.codigo+" - "+t.nome,t}))}))}},buscarCentroCustoDebounce:function(t,a){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.buscarCentroCusto(t,a)}),800)},buscarCentroCusto:function(t,a){var e=this,o={texto:t,per_page:40};n.listar(o).then((function(t){return e.centros_custo=t.data.data.map((function(t){return t.nome=t.codigo+" - "+t.nome,t}))}))},confirmar:function(t){this.sucessoAtivar=null,this.erroAtivar=null,this.acao=t,"Ativar"==t&&(this.form.vencimento_inicial=new Date)},ativar:function(){var t=this;if(this.sucessoAtivar=null,this.erroAtivar=null,this.$v.form.$touch(),this.$v.form.$invalid)return this.erroAtivar=this.$v.form,!1;var a={valor_inicial:this.form.valor_inicial,vencimento_inicial:this.form.vencimento_inicial};c.ativar(this.form.id,a).then((function(a){t.form.ativo=a.data.ativo,t.sucessoAtivar="Conta ativada com sucesso"})).catch((function(a){return t.erroAtivar=a}))},desativar:function(){var t=this;this.sucessoAtivar=null,this.erroAtivar=null,c.desativar(this.form.id).then((function(a){t.form.ativo=a.data.ativo,t.sucessoAtivar="Conta desativada com sucesso"})).catch((function(a){return t.erroAtivar=a}))},desabilitaDataPassada:function(t){return t<new Date}},computed:{currency:function(){return{decimal:",",thousands:".",prefix:this.$store.state.moeda+" ",suffix:"",precision:2,masked:!1}}}},v=e("KHd+"),d=Object(v.a)(m,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("h3",[t._v("\n                            Cadastro de Contas Recorrente  \n                            "),t.form.id?e("span",{staticClass:"float-right badge px-4 py-2",class:{"badge-primary":t.form.ativo,"badge-secondary":!t.form.ativo}},[t._v("\n                                "+t._s(t.form.ativo?"Ativo":"Inativo")+"\n                            ")]):t._e()]),t._v(" "),e("hr")])]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3"},[e("div",{staticClass:"nav flex-column nav-pills",attrs:{id:"v-pills-tab",role:"tablist","aria-orientation":"vertical"}},[e("a",{staticClass:"nav-link mb-2 active",attrs:{id:"tab-cadastro-tab","data-toggle":"pill",href:"#tab-cadastro",role:"tab","aria-controls":"tab-cadastro","aria-selected":"false"}},[t._v("Cadastro")]),t._v(" "),e("a",{staticClass:"nav-link mb-2",attrs:{id:"tab-lancamentos-tab","data-toggle":"pill",href:"#tab-lancamentos",role:"tab","aria-controls":"tab-lancamentos","aria-selected":"true"},on:{click:function(a){t.buscarLancamentos(),t.buscarSaldo()}}},[t._v("Contas Geradas")])])]),t._v(" "),e("div",{staticClass:"col-md-9"},[e("div",{staticClass:"tab-content text-muted mt-4 mt-md-0",attrs:{id:"v-pills-tabContent"}},[e("form",{staticClass:"tab-pane fade active show",attrs:{id:"tab-cadastro",role:"tabpanel","aria-labelledby":"tab-cadastro-tab"},on:{submit:function(a){return a.preventDefault(),t.submit()}}},[e("div",{staticClass:"col-md-12"},[t._m(0),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"row"},[e("label",{directives:[{name:"show",rawName:"v-show",value:t.form.id,expression:"form.id"}],staticClass:"col-sm-3 col-form-label"},[t._v("Id")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form.id,expression:"form.id"}],staticClass:"col-sm-9"},[e("input-componente",{attrs:{disabled:!0},model:{value:t.form.id,callback:function(a){t.$set(t.form,"id",a)},expression:"form.id"}})],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Fornecedor")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.parceiro_id}},[e("vue-select",{attrs:{options:t.parceiros,placeholder:"Comece a digitar para pesquisar",label:"apelido",clearable:!1},on:{search:t.buscarParceiroDebounce,input:function(a){t.$v.form.parceiro_id.$touch(),t.form.parceiro_id=t.form.parceiro.id}},model:{value:t.form.parceiro,callback:function(a){t.$set(t.form,"parceiro",a)},expression:"form.parceiro"}},[e("div",{attrs:{slot:"no-options"},slot:"no-options"},[t._v("Nenhum item para mostrar! Começe digitar para pesquisar")])])],1)],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Descrição")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("input-componente",{attrs:{validator:t.$v.form.descricao},on:{blur:t.$v.form.descricao.$touch},model:{value:t.form.descricao,callback:function(a){t.$set(t.form,"descricao",a)},expression:"form.descricao"}})],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Classificação")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.classificacao}},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.classificacao,expression:"form.classificacao"}],staticClass:"form-control",attrs:{placeholder:"Selecione uma opção"},on:{input:function(a){t.$v.form.classificacao.$touch(),t.selecionouClassificacaoConta()},change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"classificacao",a.target.multiple?e:e[0])}}},t._l(t.classificacoes,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])})),0)])],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Despesa")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.plano_conta_id}},[e("vue-select",{attrs:{options:t.planos_contas,clearable:!1,label:"nome"},on:{input:function(a){t.form.plano_conta_id=t.form.plano_conta.id},search:t.buscarContaDespesaDebounce},model:{value:t.form.plano_conta,callback:function(a){t.$set(t.form,"plano_conta",a)},expression:"form.plano_conta"}},[e("div",{attrs:{slot:"no-options"},slot:"no-options"},[t._v("Nenhum item para mostrar! Começe digitar para pesquisar")])])],1)],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Centro de Custo")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.centro_custo_id}},[e("vue-select",{attrs:{options:t.centros_custo,clearable:!1,label:"nome"},on:{input:function(a){t.form.centro_custo_id=t.form.centro_custo.id},search:t.buscarCentroCustoDebounce},model:{value:t.form.centro_custo,callback:function(a){t.$set(t.form,"centro_custo",a)},expression:"form.centro_custo"}},[e("div",{attrs:{slot:"no-options"},slot:"no-options"},[t._v("Nenhum item para mostrar! Começe digitar para pesquisar")])])],1)],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Qtde de Contas futuras")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.qtde_futuras}},[e("money",t._b({staticClass:"form-control",model:{value:t.form.qtde_futuras,callback:function(a){t.$set(t.form,"qtde_futuras",a)},expression:"form.qtde_futuras"}},"money",t.inteiro,!1))],1)],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Periodicidade")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.periodicidade,expression:"form.periodicidade"}],staticClass:"form-control",attrs:{validator:t.$v.form.periodicidade},on:{input:t.$v.form.periodicidade.$touch,change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"periodicidade",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"MENSAL"}},[t._v("MENSAL")])])])]),t._v(" "),this.form.id?t._e():e("div",{staticClass:"row"},[t._m(1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Valor Inicial")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.valor_inicial}},[e("money",t._b({staticClass:"form-control",on:{blur:t.$v.form.valor_inicial.$touch},model:{value:t.form.valor_inicial,callback:function(a){t.$set(t.form,"valor_inicial",a)},expression:"form.valor_inicial"}},"money",t.currency,!1))],1)],1),t._v(" "),e("label",{staticClass:"col-sm-3 col-form-label"},[t._v("Data da Primeira Conta")]),t._v(" "),e("div",{staticClass:"col-sm-9"},[e("container-componente",{attrs:{validator:t.$v.form.vencimento_inicial}},[e("date-picker",{attrs:{clearable:!1,format:"DD/MM/YYYY",disabledDate:t.desabilitaDataPassada},model:{value:t.form.vencimento_inicial,callback:function(a){t.$set(t.form,"vencimento_inicial",a)},expression:"form.vencimento_inicial"}})],1)],1)]),t._v(" "),e("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[t.erros||t.sucesso?e("div",{staticClass:"col-md-12 text-center"},[t.erros?e("mensagem-componente",{attrs:{titulo:t.errosTitulo,erros:t.erros},on:{fechar:function(a){t.erros=null}}}):t._e(),t._v(" "),t.sucesso?e("mensagem-componente",{attrs:{sucesso:t.sucesso},on:{fechar:function(a){t.sucesso=null}}}):t._e()],1):t._e(),t._v(" "),e("div",{staticClass:"col-md-12 button-items text-center"},[!t.form.ativo&&t.form.id?e("button",{staticClass:"btn btn-success waves-effect waves-light w-sm float-left",attrs:{type:"button",title:"Ativar","data-toggle":"modal","data-target":"#modal-ativar"},on:{click:function(a){return t.confirmar("Ativar")}}},[e("i",{staticClass:"bx bx bx-play-circle d-block font-size-24"}),t._v(" Ativar Conta\n                                ")]):t._e(),t._v(" "),t.form.ativo&&t.form.id?e("button",{staticClass:"btn btn-secondary waves-effect waves-light w-sm float-left",attrs:{type:"button",title:"Desativar","data-toggle":"modal","data-target":"#modal-ativar"},on:{click:function(a){return t.confirmar("Desativar")}}},[e("i",{staticClass:"bx bx bx-pause-circle d-block font-size-24"}),t._v(" Desativar Conta\n                                ")]):t._e(),t._v(" "),e("router-link",{staticClass:"btn btn-warning waves-effect waves-light w-sm",attrs:{title:"Voltar",to:{name:"contasRecorrentesIndex"}}},[e("i",{staticClass:"bx bx-arrow-back d-block font-size-24"}),t._v(" Voltar\n                                ")]),t._v(" "),t._m(2)],1)])])])])])])]),t._v(" "),e("div",{staticClass:"row"},[t.form.id?e("div",{staticClass:"col-md-12 text-right"},[e("log-componente",{attrs:{index:t.form.id,subject_type:"App\\Models\\Cliente\\ContaRecorrente",subject_id:t.form.id}})],1):t._e()])])]),t._v(" "),e("div",{staticClass:"modal fade",staticStyle:{display:"none"},attrs:{id:"modal-ativar",tabindex:"-1","aria-labelledby":"modal-ativar-title","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-scrollable"},[e("div",{staticClass:"modal-content",staticStyle:{"min-height":"300px"}},[e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title mt-0",attrs:{id:"modal-ativarTitle"}},[t._v(" "+t._s(t.acao)+" conta ")]),t._v(" "),t._m(3)]),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12"},[e("h4",[t._v("Tem certeza que deseja "+t._s(t.acao)+" esta conta?")])]),t._v(" "),"Ativar"===t.acao?e("div",{staticClass:"col-sm-12 form-group"},[t._v("\n                            Esta ação vai gerar "+t._s(t.form.qtde_futuras)+" contas futuras pendentes de pagamento!\n                        ")]):t._e(),t._v(" "),"Ativar"===t.acao?e("div",{staticClass:"col-sm-6 form-group"},[e("container-componente",{attrs:{label:"Vencimento Inicial",validator:t.$v.form.vencimento_inicial}},[e("date-picker",{attrs:{clearable:!1,format:"DD/MM/YYYY"},model:{value:t.form.vencimento_inicial,callback:function(a){t.$set(t.form,"vencimento_inicial",a)},expression:"form.vencimento_inicial"}})],1)],1):t._e(),t._v(" "),"Ativar"===t.acao?e("div",{staticClass:"col-sm-6 form-group"},[e("container-componente",{attrs:{label:"Valor Inicial",validator:t.$v.form.valor_inicial}},[e("money",t._b({staticClass:"form-control",on:{blur:t.$v.form.valor_inicial.$touch},model:{value:t.form.valor_inicial,callback:function(a){t.$set(t.form,"valor_inicial",a)},expression:"form.valor_inicial"}},"money",t.currency,!1))],1)],1):t._e(),t._v(" "),"Desativar"===t.acao?e("div",{staticClass:"col-sm-12 form-group"},[t._v("\n                            Esta ação vai cancelar todas as contas futuras pendentes de pagamento!\n                        ")]):t._e()]),t._v(" "),t.sucessoAtivar||t.erroAtivar?e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12"},[t.erroAtivar?e("mensagem-componente",{attrs:{erros:t.erroAtivar},on:{fechar:function(a){t.erroAtivar=null}}}):t._e(),t._v(" "),t.sucessoAtivar?e("mensagem-componente",{attrs:{sucesso:t.sucessoAtivar},on:{fechar:function(a){t.sucessoAtivar=null}}}):t._e()],1)]):t._e()]),t._v(" "),e("div",{staticClass:"modal-footer"},[t._m(4),t._v(" "),"Ativar"===t.acao?e("button",{staticClass:"btn btn-success waves-effect waves-light w-sm float-left",attrs:{disabled:t.sucessoAtivar,type:"button",title:"Ativar"},on:{click:function(a){return t.ativar()}}},[e("i",{staticClass:"bx bx bx-play-circle d-block font-size-24"}),t._v(" Ativar Conta\n                    ")]):t._e(),t._v(" "),"Desativar"===t.acao?e("button",{staticClass:"btn btn-warning waves-effect waves-light w-sm float-left",attrs:{disabled:t.sucessoAtivar,type:"button",title:"Desativar"},on:{click:function(a){return t.desativar()}}},[e("i",{staticClass:"bx bx bx-pause-circle d-block font-size-24"}),t._v(" Desativar Conta\n                    ")]):t._e()])])])])])}),[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("h4",[this._v("Dados Cadastrais")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-sm-12"},[a("hr")])},function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"btn btn-primary waves-effect waves-light w-sm",attrs:{type:"submit",title:"salvar"}},[a("i",{staticClass:"bx bxs-save d-block font-size-24"}),this._v(" Salvar\n                                ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"btn btn-secondary waves-effect waves-light w-sm float-left",attrs:{type:"button","data-dismiss":"modal"}},[a("i",{staticClass:"bx bx bx bxs-caret-left-circle d-block font-size-24"}),this._v(" Voltar")])}],!1,null,"7a2e4060",null);a.default=d.exports}}]);
//# sourceMappingURL=55.js.map